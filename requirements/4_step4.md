# Step 4: 시나리오 인수 테스트 추가

## 학습 목표

- AI 도구를 활용해 경계/핵심 예외 시나리오의 인수 테스트를 작성한다.
- 테스트 작성 가이드와 인증/데이터 가이드를 문서화해 생성 품질과 재현성을 높인다.

## 배경 및 범위

- Step 3까지 구축한 환경(`kiosk → admin → DB`, `kiosk → payments(WireMock)`)을 기반으로 한다.
- 새로운 기능 구현이 아니라, 경계/예외 흐름의 인수 테스트 보강이 목표다.

## 해야 하는 것(체크리스트)

- [ ] 테스트 작성 가이드 문서화: `atdd-tests/docs/acceptance-test-guide.md`
- [ ] 인증/실행 가이드 문서화: `atdd-tests/docs/auth-setup.md`
- [ ] AI 생성 인수 테스트(경계/예외 최소 3건) 추가: `@ai-candidate` 태그로 제출
- [ ] 검토 게이트(체크리스트) 통과 시 `@e2e`로 승격

## 요구사항

### 1. AI 입력 컨텍스트 표준화(문서로 제공)

- 포함 항목:
  - 서비스 개요(도메인, 핵심 흐름, 제약)
  - 엔드포인트 요약(메서드/경로/주요 필드/사전조건)
  - 기존 Gherkin 예시(좋은/나쁜 예 대조)
  - 인증 방법(토큰/Basic/쿠키 주입)과 환경변수 키
  - 데이터 시드 규칙(초기 데이터, 격리/정리 원칙)
- 산출물 경로 예: `atdd-tests/docs/acceptance-test-guide.md`, `atdd-tests/docs/auth-setup.md`, `atdd-tests/docs/data-seed.md`

### 2. 검토 게이트(승격 프로세스)

- 제출: AI 생성 시나리오 → `@ai-candidate` 유지
- 체크리스트 통과 시 태그 변경: `@ai-candidate` → `@e2e`
- 체크리스트(필수):
  - 의도-검증 일치(When/Then이 비즈니스 기대를 검증하는가)
  - 환경 의존 없음(포트/호스트 상수 금지, 베이스URL 외부화)
  - 데이터 격리(고유 ID/네임스페이스, 사후 정리 또는 재사용 안전성)

### 3. 경계/핵심 예외 시나리오(최소 포함)

- 재고 0 또는 수량 상한 초과
- 결제 4xx/5xx/타임아웃(모킹으로 제어)
- 중복 요청(idempotency) 및 부분 성공 처리
- 유효성 오류(필수 필드 누락/형식 불일치)

## 완료 기준(Definition of Done)

- 문서 3종(작성 가이드, 인증, 데이터 시드)이 저장소에 존재하고 최신화됐다.
- `@ai-candidate` 시나리오 ≥ 3건 생성, 검토 후 `@e2e` 승격 ≥ 2건 이상.

## 체크리스트

- [ ] 문서화(가이드/인증/시드)가 준비되어 있다.
- [ ] 경계/예외 시나리오가 최소 개수 이상 포함되었다.
